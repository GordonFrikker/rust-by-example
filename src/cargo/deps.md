# Зависимости

Большинство программ зависят от некоторых библиотек. Если вам когда-либо управляли
зависимостями вручную, вы знаете, сколько боли это может доставить боли.
К счастью экосистема языка Rust содержит такой инструмент как `cargo`!
`cargo` может управлять зависимостями проекта.

Создание нового проекта на языке Rust,

```sh
# A binary
cargo new foo

# OR A library
cargo new --lib foo
```

Для остальной части этой главы я предполагаю, что мы делаем двоичный файл, а не
библиотеку, но все понятия одинаковы.

После приведённых выше команд, вы должны увидеть что-то вроде этого:

```txt
foo
├── Cargo.toml
└── src
    └── main.rs
```

`main.rs` - это корневой файл вашего нового проекта.
`Cargo.toml` - это конфигурационный файл этого проекта (`foo`) для `cargo`.
Если посмотрите внутрь файла, вы должны увидеть что-то вроде этого:

```toml
[package]
name = "foo"
version = "0.1.0"
authors = ["mark"]

[dependencies]
```

Поле `name` под `package` определяет имя проекта. Оно используется
если Вы будете его публиковать на `crates.io` (более подробно позже).
Это так же имя выходного файла при компиляции.

Поле `version` - это версия пакета, используется система
[семантического версионирования](http://semver.org/).

Поле `authors` содержит список авторов пакета и используется при публикации.

`dependencies` - секция, где Вы можете указывать зависимости вашего проекта.

Например, предположим, что я хочу, чтобы моя программа имела отличный CLI.
Вы можете найти много отличных пакетов на [crates.io](https://crates.io)
(официальный реестр пакетов языка Rust). Один из популярных вариантов
[clap](https://crates.io/crates/clap). На момент написания этой статьи
самой последней опубликованной версией `clap` является "2.27.1".
Для добавления зависимости в ваш проект, вы можете просто добавить
соответствующую запись в Ваш `Cargo.toml` под `dependencies`: `clap = "2.27.1"`.
И конечно, , `extern crate clap` в `main.rs`. И это все! Вы можете начать
использовать `clap` в вашей программе.

`cargo` также поддерживает [другие типы зависимостей][dependencies]. Здесь только
небольшие примеры:

```toml
[package]
name = "foo"
version = "0.1.0"
authors = ["mark"]

[dependencies]
clap = "2.27.1" # из crates.io
rand = { git = "https://github.com/rust-lang-nursery/rand" } # из онлайн репозитория
bar = { path = "../bar" } # из локальной файловой системы
```

`cargo` больше чем менеджер зависимостей. Все поддерживаемые возможности доступны
в [спецификации формата][manifest] `Cargo.toml`.

Для сборки проекта Вы можете выполнить команду `cargo build` в любой директории проекта
(включая поддиректории!). Также Вы можете выполнить `cargo run` для сборки и запуска.
Обратите внимание, что эти команды разрешат все зависимости, скачают пакеты
если нужно, то и соберут все, включая ваш пакет. (Обратите внимание, что это только
собирает то, что он ещё не собрано, подобно `make`).

Вуаля! Вот и все!

[manifest]: https://doc.rust-lang.org/cargo/reference/manifest.html
[dependencies]: https://doc.rust-lang.org/cargo/reference/specifying-dependencies.html
